/*! For license information please see sitehq-widget.bundle.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("React"),require("ReactDOM")):"function"==typeof define&&define.amd?define(["React","ReactDOM"],e):"object"==typeof exports?exports.SiteHQChat=e(require("React"),require("ReactDOM")):t.SiteHQChat=e(t.React,t.ReactDOM)}(this,((t,e)=>(()=>{"use strict";var n={338:(t,e,n)=>{var o=n(845);e.H=o.createRoot,o.hydrateRoot},845:t=>{t.exports=e},883:e=>{e.exports=t}},o={};function r(t){var e=o[t];if(void 0!==e)return e.exports;var i=o[t]={exports:{}};return n[t](i,i.exports,r),i.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var i=r(883),a=r.n(i),s=r(338);function c(){return c=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)({}).hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},c.apply(null,arguments)}function l(t){const e=new Uint8Array(t);return window.btoa(String.fromCharCode(...e))}function u(t){const e=window.atob(t),n=e.length,o=new Uint8Array(n);for(let t=0;t<n;t++)o[t]=e.charCodeAt(t);return o.buffer}const d=new Blob(['\n      const BIAS = 0x84;\n      const CLIP = 32635;\n      const encodeTable = [\n        0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,\n        4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,\n        5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,\n        5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,\n        6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,\n        6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,\n        6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,\n        6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,\n        7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,\n        7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,\n        7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,\n        7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,\n        7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,\n        7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,\n        7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,\n        7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7\n      ];\n      \n      function encodeSample(sample) {\n        let sign;\n        let exponent;\n        let mantissa;\n        let muLawSample;\n        sign = (sample >> 8) & 0x80;\n        if (sign !== 0) sample = -sample;\n        sample = sample + BIAS;\n        if (sample > CLIP) sample = CLIP;\n        exponent = encodeTable[(sample>>7) & 0xFF];\n        mantissa = (sample >> (exponent+3)) & 0x0F;\n        muLawSample = ~(sign | (exponent << 4) | mantissa);\n        \n        return muLawSample;\n      }\n    \n      class RawAudioProcessor extends AudioWorkletProcessor {\n        constructor() {\n          super();\n                    \n          this.port.onmessage = ({ data }) => {\n            this.buffer = []; // Initialize an empty buffer\n            this.bufferSize = data.sampleRate / 4;\n            \n            if (globalThis.LibSampleRate && sampleRate !== data.sampleRate) {\n              globalThis.LibSampleRate.create(1, sampleRate, data.sampleRate).then(resampler => {\n                this.resampler = resampler;\n              });\n            } \n          };\n        }\n        process(inputs) {\n          if (!this.buffer) {\n            return true;\n          }\n          \n          const input = inputs[0]; // Get the first input node\n          if (input.length > 0) {\n            let channelData = input[0]; // Get the first channel\'s data\n\n            // Resample the audio if necessary\n            if (this.resampler) {\n              channelData = this.resampler.full(channelData);\n            }\n\n            // Add channel data to the buffer\n            this.buffer.push(...channelData);\n            // Get max volume \n            let sum = 0.0;\n            for (let i = 0; i < channelData.length; i++) {\n              sum += channelData[i] * channelData[i];\n            }\n            const maxVolume = Math.sqrt(sum / channelData.length);\n            // Check if buffer size has reached or exceeded the threshold\n            if (this.buffer.length >= this.bufferSize) {\n              const float32Array = new Float32Array(this.buffer)\n              let encodedArray = this.format === "ulaw"\n                ? new Uint8Array(float32Array.length)\n                : new Int16Array(float32Array.length);\n\n              // Iterate through the Float32Array and convert each sample to PCM16\n              for (let i = 0; i < float32Array.length; i++) {\n                // Clamp the value to the range [-1, 1]\n                let sample = Math.max(-1, Math.min(1, float32Array[i]));\n\n                // Scale the sample to the range [-32768, 32767]\n                let value = sample < 0 ? sample * 32768 : sample * 32767;\n                if (this.format === "ulaw") {\n                  value = encodeSample(Math.round(value));\n                }\n\n                encodedArray[i] = value;\n              }\n\n              // Send the buffered data to the main script\n              this.port.postMessage([encodedArray, maxVolume]);\n\n              // Clear the buffer after sending\n              this.buffer = [];\n            }\n          }\n          return true; // Continue processing\n        }\n      }\n      registerProcessor("raw-audio-processor", RawAudioProcessor);\n  '],{type:"application/javascript"}),h=URL.createObjectURL(d);class p{static async create({sampleRate:t,format:e,preferHeadphonesForIosDevices:n}){let o=null,r=null;try{const i={sampleRate:{ideal:t},echoCancellation:{ideal:!0},noiseSuppression:{ideal:!0}},a=await navigator.mediaDevices.getUserMedia({audio:!0});if(null==a||a.getTracks().forEach((t=>t.stop())),(["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document)&&n){const t=(await window.navigator.mediaDevices.enumerateDevices()).find((t=>"audioinput"===t.kind&&["airpod","headphone","earphone"].find((e=>t.label.toLowerCase().includes(e)))));t&&(i.deviceId={ideal:t.deviceId})}const s=navigator.mediaDevices.getSupportedConstraints().sampleRate;o=new window.AudioContext(s?{sampleRate:t}:{});const c=o.createAnalyser();s||await o.audioWorklet.addModule("https://cdn.jsdelivr.net/npm/@alexanderolsen/libsamplerate-js@2.1.2/dist/libsamplerate.worklet.js"),await o.audioWorklet.addModule(h),r=await navigator.mediaDevices.getUserMedia({audio:i});const l=o.createMediaStreamSource(r),u=new AudioWorkletNode(o,"raw-audio-processor");return u.port.postMessage({type:"setFormat",format:e,sampleRate:t}),l.connect(c),c.connect(u),new p(o,c,u,r)}catch(t){var i,a;throw null==(i=r)||i.getTracks().forEach((t=>t.stop())),null==(a=o)||a.close(),t}}constructor(t,e,n,o){this.context=void 0,this.analyser=void 0,this.worklet=void 0,this.inputStream=void 0,this.context=t,this.analyser=e,this.worklet=n,this.inputStream=o}async close(){this.inputStream.getTracks().forEach((t=>t.stop())),await this.context.close()}}const f=new Blob(['\n      const decodeTable = [0,132,396,924,1980,4092,8316,16764];\n      \n      export function decodeSample(muLawSample) {\n        let sign;\n        let exponent;\n        let mantissa;\n        let sample;\n        muLawSample = ~muLawSample;\n        sign = (muLawSample & 0x80);\n        exponent = (muLawSample >> 4) & 0x07;\n        mantissa = muLawSample & 0x0F;\n        sample = decodeTable[exponent] + (mantissa << (exponent+3));\n        if (sign !== 0) sample = -sample;\n\n        return sample;\n      }\n      \n      class AudioConcatProcessor extends AudioWorkletProcessor {\n        constructor() {\n          super();\n          this.buffers = []; // Initialize an empty buffer\n          this.cursor = 0;\n          this.currentBuffer = null;\n          this.wasInterrupted = false;\n          this.finished = false;\n          \n          this.port.onmessage = ({ data }) => {\n            switch (data.type) {\n              case "setFormat":\n                this.format = data.format;\n                break;\n              case "buffer":\n                this.wasInterrupted = false;\n                this.buffers.push(\n                  this.format === "ulaw"\n                    ? new Uint8Array(data.buffer)\n                    : new Int16Array(data.buffer)\n                );\n                break;\n              case "interrupt":\n                this.wasInterrupted = true;\n                break;\n              case "clearInterrupted":\n                if (this.wasInterrupted) {\n                  this.wasInterrupted = false;\n                  this.buffers = [];\n                  this.currentBuffer = null;\n                }\n            }\n          };\n        }\n        process(_, outputs) {\n          let finished = false;\n          const output = outputs[0][0];\n          for (let i = 0; i < output.length; i++) {\n            if (!this.currentBuffer) {\n              if (this.buffers.length === 0) {\n                finished = true;\n                break;\n              }\n              this.currentBuffer = this.buffers.shift();\n              this.cursor = 0;\n            }\n\n            let value = this.currentBuffer[this.cursor];\n            if (this.format === "ulaw") {\n              value = decodeSample(value);\n            }\n            output[i] = value / 32768;\n            this.cursor++;\n\n            if (this.cursor >= this.currentBuffer.length) {\n              this.currentBuffer = null;\n            }\n          }\n\n          if (this.finished !== finished) {\n            this.finished = finished;\n            this.port.postMessage({ type: "process", finished });\n          }\n\n          return true; // Continue processing\n        }\n      }\n\n      registerProcessor("audio-concat-processor", AudioConcatProcessor);\n    '],{type:"application/javascript"}),g=URL.createObjectURL(f);class m{static async create({sampleRate:t,format:e}){let n=null;try{n=new AudioContext({sampleRate:t});const o=n.createAnalyser(),r=n.createGain();r.connect(o),o.connect(n.destination),await n.audioWorklet.addModule(g);const i=new AudioWorkletNode(n,"audio-concat-processor");return i.port.postMessage({type:"setFormat",format:e}),i.connect(r),new m(n,o,r,i)}catch(t){var o;throw null==(o=n)||o.close(),t}}constructor(t,e,n,o){this.context=void 0,this.analyser=void 0,this.gain=void 0,this.worklet=void 0,this.context=t,this.analyser=e,this.gain=n,this.worklet=o}async close(){await this.context.close()}}function v(t){return!!t.type}class y{static async create(t){let e=null;try{var n;const o=null!=(n=t.origin)?n:"wss://api.elevenlabs.io",r=t.signedUrl?t.signedUrl:o+"/v1/convai/conversation?agent_id="+t.agentId,i=["convai"];t.authorization&&i.push(`bearer.${t.authorization}`),e=new WebSocket(r,i);const a=await new Promise(((n,o)=>{e.addEventListener("open",(()=>{var n;const o={type:"conversation_initiation_client_data"};var r,i,a,s;t.overrides&&(o.conversation_config_override={agent:{prompt:null==(r=t.overrides.agent)?void 0:r.prompt,first_message:null==(i=t.overrides.agent)?void 0:i.firstMessage,language:null==(a=t.overrides.agent)?void 0:a.language},tts:{voice_id:null==(s=t.overrides.tts)?void 0:s.voiceId}}),t.customLlmExtraBody&&(o.custom_llm_extra_body=t.customLlmExtraBody),t.dynamicVariables&&(o.dynamic_variables=t.dynamicVariables),null==(n=e)||n.send(JSON.stringify(o))}),{once:!0}),e.addEventListener("error",o),e.addEventListener("close",o),e.addEventListener("message",(t=>{const e=JSON.parse(t.data);v(e)&&("conversation_initiation_metadata"===e.type?n(e.conversation_initiation_metadata_event):console.warn("First received message is not conversation metadata."))}),{once:!0})})),{conversation_id:s,agent_output_audio_format:c,user_input_audio_format:l}=a,u=b(null!=l?l:"pcm_16000"),d=b(c);return new y(e,s,u,d)}catch(t){var o;throw null==(o=e)||o.close(),t}}constructor(t,e,n,o){this.socket=void 0,this.conversationId=void 0,this.inputFormat=void 0,this.outputFormat=void 0,this.socket=t,this.conversationId=e,this.inputFormat=n,this.outputFormat=o}close(){this.socket.close()}sendMessage(t){this.socket.send(JSON.stringify(t))}}function b(t){const[e,n]=t.split("_");if(!["pcm","ulaw"].includes(e))throw new Error(`Invalid format: ${t}`);const o=parseInt(n);if(isNaN(o))throw new Error(`Invalid sample rate: ${n}`);return{format:e,sampleRate:o}}const w={clientTools:{}},q={onConnect:()=>{},onDebug:()=>{},onDisconnect:()=>{},onError:()=>{},onMessage:()=>{},onModeChange:()=>{},onStatusChange:()=>{},onCanSendFeedbackChange:()=>{}};class x{static async startSession(t){const e=c({},w,q,t);e.onStatusChange({status:"connecting"}),e.onCanSendFeedbackChange({canSendFeedback:!1});let n=null,o=null,r=null;try{return o=await y.create(t),[n,r]=await Promise.all([p.create(c({},o.inputFormat,{preferHeadphonesForIosDevices:t.preferHeadphonesForIosDevices})),m.create(o.outputFormat)]),new x(e,o,n,r)}catch(t){var i,a,s;throw e.onStatusChange({status:"disconnected"}),null==(i=o)||i.close(),await(null==(a=n)?void 0:a.close()),await(null==(s=r)?void 0:s.close()),t}}constructor(t,e,n,o){var r=this;this.options=void 0,this.connection=void 0,this.input=void 0,this.output=void 0,this.lastInterruptTimestamp=0,this.mode="listening",this.status="connecting",this.inputFrequencyData=void 0,this.outputFrequencyData=void 0,this.volume=1,this.currentEventId=1,this.lastFeedbackEventId=1,this.canSendFeedback=!1,this.endSession=async function(){"connected"===r.status&&(r.updateStatus("disconnecting"),r.connection.close(),await r.input.close(),await r.output.close(),r.updateStatus("disconnected"))},this.updateMode=t=>{t!==this.mode&&(this.mode=t,this.options.onModeChange({mode:t}))},this.updateStatus=t=>{t!==this.status&&(this.status=t,this.options.onStatusChange({status:t}))},this.updateCanSendFeedback=()=>{const t=this.currentEventId!==this.lastFeedbackEventId;this.canSendFeedback!==t&&(this.canSendFeedback=t,this.options.onCanSendFeedbackChange({canSendFeedback:t}))},this.onEvent=async function(t){try{const n=JSON.parse(t.data);if(!v(n))return;switch(n.type){case"interruption":n.interruption_event&&(r.lastInterruptTimestamp=n.interruption_event.event_id),r.fadeOutAudio();break;case"agent_response":r.options.onMessage({source:"ai",message:n.agent_response_event.agent_response});break;case"user_transcript":r.options.onMessage({source:"user",message:n.user_transcription_event.user_transcript});break;case"internal_tentative_agent_response":r.options.onDebug({type:"tentative_agent_response",response:n.tentative_agent_response_internal_event.tentative_agent_response});break;case"client_tool_call":if(r.options.clientTools.hasOwnProperty(n.client_tool_call.tool_name)){try{var e;const t=null!=(e=await r.options.clientTools[n.client_tool_call.tool_name](n.client_tool_call.parameters))?e:"Client tool execution successful.";r.connection.sendMessage({type:"client_tool_result",tool_call_id:n.client_tool_call.tool_call_id,result:t,is_error:!1})}catch(t){r.onError("Client tool execution failed with following error: "+(null==t?void 0:t.message),{clientToolName:n.client_tool_call.tool_name}),r.connection.sendMessage({type:"client_tool_result",tool_call_id:n.client_tool_call.tool_call_id,result:"Client tool execution failed: "+(null==t?void 0:t.message),is_error:!0})}break}if(r.options.onUnhandledClientToolCall){r.options.onUnhandledClientToolCall(n.client_tool_call);break}r.onError(`Client tool with name ${n.client_tool_call.tool_name} is not defined on client`,{clientToolName:n.client_tool_call.tool_name}),r.connection.sendMessage({type:"client_tool_result",tool_call_id:n.client_tool_call.tool_call_id,result:`Client tool with name ${n.client_tool_call.tool_name} is not defined on client`,is_error:!0});break;case"audio":r.lastInterruptTimestamp<=n.audio_event.event_id&&(r.addAudioBase64Chunk(n.audio_event.audio_base_64),r.currentEventId=n.audio_event.event_id,r.updateCanSendFeedback(),r.updateMode("speaking"));break;case"ping":r.connection.sendMessage({type:"pong",event_id:n.ping_event.event_id});break;default:r.options.onDebug(n)}}catch(e){return void r.onError("Failed to parse event data",{event:t})}},this.onInputWorkletMessage=t=>{"connected"===this.status&&this.connection.sendMessage({user_audio_chunk:l(t.data[0].buffer)})},this.onOutputWorkletMessage=({data:t})=>{"process"===t.type&&this.updateMode(t.finished?"listening":"speaking")},this.addAudioBase64Chunk=async function(t){r.output.gain.gain.value=r.volume,r.output.worklet.port.postMessage({type:"clearInterrupted"}),r.output.worklet.port.postMessage({type:"buffer",buffer:u(t)})},this.fadeOutAudio=async function(){r.updateMode("listening"),r.output.worklet.port.postMessage({type:"interrupt"}),r.output.gain.gain.exponentialRampToValueAtTime(1e-4,r.output.context.currentTime+2),setTimeout((()=>{r.output.gain.gain.value=r.volume,r.output.worklet.port.postMessage({type:"clearInterrupted"})}),2e3)},this.onError=(t,e)=>{console.error(t,e),this.options.onError(t,e)},this.calculateVolume=t=>{if(0===t.length)return 0;let e=0;for(let n=0;n<t.length;n++)e+=t[n]/255;return e/=t.length,e<0?0:e>1?1:e},this.getId=()=>this.connection.conversationId,this.setVolume=({volume:t})=>{this.volume=t},this.getInputByteFrequencyData=()=>(null!=this.inputFrequencyData||(this.inputFrequencyData=new Uint8Array(this.input.analyser.frequencyBinCount)),this.input.analyser.getByteFrequencyData(this.inputFrequencyData),this.inputFrequencyData),this.getOutputByteFrequencyData=()=>(null!=this.outputFrequencyData||(this.outputFrequencyData=new Uint8Array(this.output.analyser.frequencyBinCount)),this.output.analyser.getByteFrequencyData(this.outputFrequencyData),this.outputFrequencyData),this.getInputVolume=()=>this.calculateVolume(this.getInputByteFrequencyData()),this.getOutputVolume=()=>this.calculateVolume(this.getOutputByteFrequencyData()),this.sendFeedback=t=>{this.canSendFeedback?(this.connection.sendMessage({type:"feedback",score:t?"like":"dislike",event_id:this.currentEventId}),this.lastFeedbackEventId=this.currentEventId,this.updateCanSendFeedback()):console.warn(0===this.lastFeedbackEventId?"Cannot send feedback: the conversation has not started yet.":"Cannot send feedback: feedback has already been sent for the current response.")},this.options=t,this.connection=e,this.input=n,this.output=o,this.options.onConnect({conversationId:e.conversationId}),this.connection.socket.addEventListener("message",(t=>{this.onEvent(t)})),this.connection.socket.addEventListener("error",(t=>{this.updateStatus("disconnected"),this.onError("Socket error",t)})),this.connection.socket.addEventListener("close",(()=>{this.updateStatus("disconnected"),this.options.onDisconnect()})),this.input.worklet.port.onmessage=this.onInputWorkletMessage,this.output.worklet.port.onmessage=this.onOutputWorkletMessage,this.updateStatus("connected")}}function k(){return k=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)({}).hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},k.apply(null,arguments)}function S(t){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S(t)}function C(){C=function(){return e};var t,e={},n=Object.prototype,o=n.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function u(t,e,n,o){var i=e&&e.prototype instanceof v?e:v,a=Object.create(i.prototype),s=new I(o||[]);return r(a,"_invoke",{value:L(t,n,s)}),a}function d(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var h="suspendedStart",p="suspendedYield",f="executing",g="completed",m={};function v(){}function y(){}function b(){}var w={};l(w,a,(function(){return this}));var q=Object.getPrototypeOf,x=q&&q(q(A([])));x&&x!==n&&o.call(x,a)&&(w=x);var k=b.prototype=v.prototype=Object.create(w);function _(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function n(r,i,a,s){var c=d(t[r],t,i);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==S(u)&&o.call(u,"__await")?e.resolve(u.__await).then((function(t){n("next",t,a,s)}),(function(t){n("throw",t,a,s)})):e.resolve(u).then((function(t){l.value=t,a(l)}),(function(t){return n("throw",t,a,s)}))}s(c.arg)}var i;r(this,"_invoke",{value:function(t,o){function r(){return new e((function(e,r){n(t,o,e,r)}))}return i=i?i.then(r,r):r()}})}function L(e,n,o){var r=h;return function(i,a){if(r===f)throw Error("Generator is already running");if(r===g){if("throw"===i)throw a;return{value:t,done:!0}}for(o.method=i,o.arg=a;;){var s=o.delegate;if(s){var c=F(s,o);if(c){if(c===m)continue;return c}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if(r===h)throw r=g,o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);r=f;var l=d(e,n,o);if("normal"===l.type){if(r=o.done?g:p,l.arg===m)continue;return{value:l.arg,done:o.done}}"throw"===l.type&&(r=g,o.method="throw",o.arg=l.arg)}}}function F(e,n){var o=n.method,r=e.iterator[o];if(r===t)return n.delegate=null,"throw"===o&&e.iterator.return&&(n.method="return",n.arg=t,F(e,n),"throw"===n.method)||"return"!==o&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+o+"' method")),m;var i=d(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,m;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function M(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(M,this),this.reset(!0)}function A(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function n(){for(;++r<e.length;)if(o.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(S(e)+" is not iterable")}return y.prototype=b,r(k,"constructor",{value:b,configurable:!0}),r(b,"constructor",{value:y,configurable:!0}),y.displayName=l(b,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,l(t,c,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},_(E.prototype),l(E.prototype,s,(function(){return this})),e.AsyncIterator=E,e.async=function(t,n,o,r,i){void 0===i&&(i=Promise);var a=new E(u(t,n,o,r),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},_(k),l(k,c,"Generator"),l(k,a,(function(){return this})),l(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var o in e)n.push(o);return n.reverse(),function t(){for(;n.length;){var o=n.pop();if(o in e)return t.value=o,t.done=!1,t}return t.done=!0,t}},e.values=A,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(o,r){return s.type="throw",s.arg=e,n.next=o,r&&(n.method="next",n.arg=t),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),l=o.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),O(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var o=n.completion;if("throw"===o.type){var r=o.arg;O(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(e,n,o){return this.delegate={iterator:A(e),resultName:n,nextLoc:o},"next"===this.method&&(this.arg=t),m}},e}function _(t,e,n,o,r,i,a){try{var s=t[i](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(o,r)}function E(t){return function(){var e=this,n=arguments;return new Promise((function(o,r){var i=t.apply(e,n);function a(t){_(i,o,r,a,s,"next",t)}function s(t){_(i,o,r,a,s,"throw",t)}a(void 0)}))}}var L=function(t){var e=t.apiKey,n=t.agentId;t.container,console.log("SiteHQChatController: Component mounted with apiKey:",e,"agentId:",n);var o=function(t){const e=(0,i.useRef)(null),n=(0,i.useRef)(null),[o,r]=(0,i.useState)("disconnected"),[a,s]=(0,i.useState)(!1),[c,l]=(0,i.useState)("listening");return(0,i.useEffect)((()=>()=>{var t;null==(t=e.current)||t.endSession()}),[]),{startSession:async o=>{if(e.current)return e.current.getId();if(n.current)return(await n.current).getId();try{return n.current=x.startSession(k({},null!=t?t:{},null!=o?o:{},{onModeChange:({mode:t})=>{l(t)},onStatusChange:({status:t})=>{r(t)},onCanSendFeedbackChange:({canSendFeedback:t})=>{s(t)}})),e.current=await n.current,e.current.getId()}finally{n.current=null}},endSession:async()=>{const t=e.current;e.current=null,await(null==t?void 0:t.endSession())},setVolume:({volume:t})=>{var n;null==(n=e.current)||n.setVolume({volume:t})},getInputByteFrequencyData:()=>{var t;return null==(t=e.current)?void 0:t.getInputByteFrequencyData()},getOutputByteFrequencyData:()=>{var t;return null==(t=e.current)?void 0:t.getOutputByteFrequencyData()},getInputVolume:()=>{var t,n;return null!=(t=null==(n=e.current)?void 0:n.getInputVolume())?t:0},getOutputVolume:()=>{var t,n;return null!=(t=null==(n=e.current)?void 0:n.getOutputVolume())?t:0},sendFeedback:t=>{var n;null==(n=e.current)||n.sendFeedback(t)},status:o,canSendFeedback:a,isSpeaking:"speaking"===c}}({onConnect:function(){return console.log("SiteHQChatController: Connected to ElevenLabs")},onDisconnect:function(){return console.log("SiteHQChatController: Disconnected from ElevenLabs")},onError:function(t){return console.error("SiteHQChatController: Conversation error:",t)},onMessage:function(t){return console.log("SiteHQChatController: Message received:",t)}});console.log("SiteHQChatController: useConversation status:",o.status);var r=(0,i.useCallback)(E(C().mark((function t(){var r,i,a;return C().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("SiteHQChatController: handleAcceptTerms called"),t.prev=1,console.log("SiteHQChatController: Requesting microphone access..."),t.next=5,navigator.mediaDevices.getUserMedia({audio:!0});case 5:return console.log("SiteHQChatController: Microphone access granted"),console.log("SiteHQChatController: Fetching signed URL..."),t.next=9,fetch("https://c46a1c6d-3d97-4f35-8e97-39c88d29fcc3-00-3jso8wzm23kek.pike.replit.dev/api/get-signed-url?agentId=".concat(n),{headers:{Authorization:"Bearer ".concat(e)}});case 9:if((r=t.sent).ok){t.next=12;break}throw new Error("Failed to fetch signed URL");case 12:return t.next=14,r.json();case 14:return i=t.sent,a=i.signedUrl,console.log("SiteHQChatController: Signed URL fetched:",a),console.log("SiteHQChatController: Starting session..."),t.next=20,o.startSession({signedUrl:a});case 20:console.log("SiteHQChatController: Session started"),t.next=27;break;case 23:t.prev=23,t.t0=t.catch(1),console.error("SiteHQChatController: Failed to start conversation:",t.t0),document.dispatchEvent(new CustomEvent("sitehq-status-update",{detail:{status:"error"}}));case 27:case"end":return t.stop()}}),t,null,[[1,23]])}))),[e,n,o]),a=(0,i.useCallback)((function(){console.log("SiteHQChatController: handleDisconnect called"),o.endSession()}),[o]);return(0,i.useEffect)((function(){console.log("SiteHQChatController: Conversation status changed:",o.status,"isSpeaking:",o.isSpeaking);var t="disconnected";"connected"===o.status?t=o.isSpeaking?"speaking":"listening":"connecting"===o.status&&(t="thinking"),document.dispatchEvent(new CustomEvent("sitehq-status-update",{detail:{status:t}}))}),[o.status,o.isSpeaking]),(0,i.useEffect)((function(){var t=function(){return r()},e=function(){return a()};return console.log("SiteHQChatController: Adding event listeners for sitehq-accept-terms and sitehq-disconnect"),document.addEventListener("sitehq-accept-terms",t),document.addEventListener("sitehq-disconnect",e),function(){console.log("SiteHQChatController: Removing event listeners"),document.removeEventListener("sitehq-accept-terms",t),document.removeEventListener("sitehq-disconnect",e)}}),[r,a]),null};function F(t){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},F(t)}function M(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function O(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?M(Object(n),!0).forEach((function(e){T(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function I(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,P(o.key),o)}}function A(t){var e="function"==typeof Map?new Map:void 0;return A=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return function(t,e,n){if(D())return Reflect.construct.apply(null,arguments);var o=[null];o.push.apply(o,e);var r=new(t.bind.apply(t,o));return n&&j(r,n.prototype),r}(t,arguments,R(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),j(n,t)},A(t)}function D(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(D=function(){return!!t})()}function j(t,e){return j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},j(t,e)}function R(t){return R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},R(t)}function T(t,e,n){return(e=P(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function P(t){var e=function(t){if("object"!=F(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=F(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==F(e)?e:e+""}document.addEventListener("sitehq-init",(function(t){console.log("SiteHQChatController: sitehq-init event received:",t.detail);var e=t.detail,n=e.apiKey,o=e.agentId,r=e.container;(0,s.H)(r).render(a().createElement(L,{apiKey:n,agentId:o,container:r}))}));var B=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),T(t=function(t,e,n){return e=R(e),function(t,e){if(e&&("object"==F(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,D()?Reflect.construct(e,n||[],R(t).constructor):e.apply(t,n))}(this,e),"SVGS",{chatBubble:"M21 11.5C21 16.1944 16.9706 20 12 20C10.9 20 9.83943 19.8325 8.85145 19.5247C8.17238 19.3139 7.8323 19.2083 7.68265 19.2292C7.53301 19.25 7.31884 19.3693 6.88694 19.6084L4.8 20.8L4.3636 20.9964C4.01558 21.1495 3.84157 21.2261 3.67736 21.2433C3.38636 21.2725 3.09829 21.1872 2.87926 21.0113C2.79366 20.9488 2.72192 20.8663 2.5764 20.7055C2.19781 20.2685 2.18538 19.6598 2.54001 19.2082L3 18.6462L4.09513 17.2981C4.25177 17.1069 4.33008 17.0113 4.38058 16.9031C4.43108 16.795 4.4473 16.6716 4.47097 16.4224C4.49464 16.1732 4.45304 15.9049 4.37088 15.3755C4.12225 13.7754 4 13 4 11.5C4 6.80558 8.02944 3 13 3C17.9706 3 21 6.80558 21 11.5Z",close:"M18 6L6 18 M6 6L18 18",send:"M22 2L11 13 M22 2L15 22L11 13M22 2L2 9L11 13",sun:"M12 16A4 4 0 0 0 16 12A4 4 0 0 0 12 8A4 4 0 0 0 8 12A4 4 0 0 0 12 16Z M12 2V4 M12 20V22 M4.93 4.93L6.34 6.34 M17.66 17.66L19.07 19.07 M2 12H4 M20 12H22 M6.34 17.66L4.93 19.07 M19.07 4.93L17.66 6.34",moon:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",hangup:"M10 14L12 12M12 12L14 10M12 12L10 10M12 12L14 14M6 18H18C20.2091 18 22 16.2091 22 14V10C22 7.79086 20.2091 6 18 6H6C3.79086 6 2 7.79086 2 10V14C2 16.2091 3.79086 18 6 18Z"}),t.attachShadow({mode:"open"}),t.config={},t.state={isOpen:!1,isDarkMode:!1,status:"disconnected",isSpeaking:!1,acceptedTerms:!1,isTyping:!1},t.refs={},t.silenceTimeout=null,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&j(t,e)}(e,t),function(t,e){return e&&I(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}(e,[{key:"connectedCallback",value:function(){var t=this;this.loadConfig(),this.render(),this.setupEventListeners(),this.setupReactContainer(),this.config.initiallyOpen&&this.toggleChatWindow(!0),document.addEventListener("sitehq-status-update",(function(e){t.setStatus(e.detail.status)}))}},{key:"disconnectedCallback",value:function(){this.cleanup()}},{key:"loadConfig",value:function(){var t={apiKey:"demo-key",agentId:"demo-agent",theme:{primary:"#5c078c",background:"#ffffff",text:"#333333"},darkMode:!1,position:"bottom-right",initiallyOpen:!1,widgetTitle:"SiteHQ Assistant",useSolarSystemTheme:!0};if(this.config={apiKey:this.getAttribute("api-key")||t.apiKey,agentId:this.getAttribute("agent-id")||t.agentId,position:this.getAttribute("position")||t.position,initiallyOpen:"true"===this.getAttribute("initially-open"),widgetTitle:this.getAttribute("title")||t.widgetTitle,darkMode:"true"===this.getAttribute("dark-mode"),useSolarSystemTheme:"true"===this.getAttribute("solar-system-theme")||t.useSolarSystemTheme,theme:t.theme},this.hasAttribute("theme"))try{var e=JSON.parse(this.getAttribute("theme"));this.config.theme=O(O({},t.theme),e)}catch(t){console.warn("Invalid theme JSON:",t)}this.state.isDarkMode=this.config.darkMode,this.shadowRoot.host.style.setProperty("--primary-color",this.config.theme.primary)}},{key:"createSVG",value:function(t){var e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.setAttribute("width","24"),e.setAttribute("height","24"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.setAttribute("stroke","currentColor"),e.setAttribute("stroke-width","2"),e.setAttribute("stroke-linecap","round"),e.setAttribute("stroke-linejoin","round");var n=document.createElementNS("http://www.w3.org/2000/svg","path");return n.setAttribute("d",t),e.appendChild(n),e}},{key:"render",value:function(){if(this.shadowRoot.innerHTML='\n      <style>\n        .sitehq-container {\n          font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;\n          font-size: 14px;\n          line-height: 1.5;\n          color: #333;\n          position: fixed;\n          z-index: 9999;\n          bottom: 20px;\n          right: 20px;\n          display: flex;\n          flex-direction: column;\n          align-items: flex-end;\n        }\n\n        .sitehq-container.sitehq-dark-mode {\n          color: #f5f5f5;\n        }\n\n        .sitehq-container.sitehq-top-right {\n          top: 20px;\n          right: 20px;\n          bottom: auto;\n          left: auto;\n        }\n\n        .sitehq-container.sitehq-top-left {\n          top: 20px;\n          left: 20px;\n          bottom: auto;\n          right: auto;\n        }\n\n        .sitehq-container.sitehq-bottom-left {\n          bottom: 20px;\n          left: 20px;\n          top: auto;\n          right: auto;\n        }\n\n        .sitehq-toggle-button {\n          width: 56px;\n          height: 56px;\n          border-radius: 50%;\n          background: radial-gradient(circle at 30% 30%, #F95638, #F95638);\n          color: white;\n          border: none;\n          cursor: pointer;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          box-shadow: 0 4px 10px rgba(92, 7, 140, 0.3);\n          position: relative;\n          transition: transform 0.3s ease, box-shadow 0.3s ease;\n          animation: sitehq-float 3s ease-in-out infinite;\n        }\n\n        .sitehq-sun-particle {\n          animation: sitehq-orbit 8s linear infinite !important;\n          box-shadow: 0 0 10px rgba(255, 204, 0, 0.8);\n        }\n\n        .sitehq-planet-particle {\n          animation: sitehq-orbit-reverse 6s linear infinite !important;\n        }\n\n        @keyframes sitehq-orbit {\n          0% {\n            transform: rotate(0deg) translateX(6px) rotate(0deg);\n          }\n          100% {\n            transform: rotate(360deg) translateX(6px) rotate(-360deg);\n          }\n        }\n\n        @keyframes sitehq-orbit-reverse {\n          0% {\n            transform: rotate(0deg) translateX(4px) rotate(0deg);\n          }\n          100% {\n            transform: rotate(-360deg) translateX(4px) rotate(360deg);\n          }\n        }\n\n        @keyframes sitehq-float {\n          0%, 100% {\n            transform: translateY(0);\n          }\n          50% {\n            transform: translateY(-10px);\n          }\n        }\n\n        .sitehq-toggle-button:hover {\n          transform: scale(1.05);\n          box-shadow: 0 0 0 8px rgba(255, 165, 0, 0.4),\n                      0 6px 25px rgba(0, 0, 0, 0.3);\n        }\n\n        .sitehq-toggle-button:focus {\n          outline: none;\n        }\n\n        .sitehq-toggle-button::after {\n          content: \'\';\n          position: absolute;\n          inset: 0;\n          border-radius: 50%;\n          background: #FFA500;\n          opacity: 0;\n          z-index: -1;\n          animation: sitehq-pulse 2s infinite;\n        }\n\n        @keyframes sitehq-pulse {\n          0% {\n            transform: scale(1);\n            opacity: 0.3;\n            box-shadow: 0 0 8px rgba(255, 165, 0, 0.5);\n          }\n          100% {\n            transform: scale(1.5);\n            opacity: 0;\n            box-shadow: 0 0 20px rgba(255, 165, 0, 0);\n          }\n        }\n\n        .sitehq-particle {\n          position: absolute;\n          width: 12px;\n          height: 12px;\n          border-radius: 50%;\n          pointer-events: none;\n        }\n\n        .sitehq-particle:nth-child(1) {\n          top: -10px;\n          right: -5px;\n          background-color: #FFCC00;\n          animation: sitehq-float-particle 4s ease-in-out infinite;\n        }\n\n        .sitehq-particle:nth-child(2) {\n          bottom: -8px;\n          left: -5px;\n          width: 8px;\n          height: 8px;\n          background-color: #00CCFF;\n          animation: sitehq-float-particle 3.5s ease-in-out infinite 0.5s;\n        }\n\n        @keyframes sitehq-float-particle {\n          0%, 100% {\n            transform: translate(0, 0);\n          }\n          50% {\n            transform: translate(5px, -10px);\n          }\n        }\n\n        .sitehq-tooltip {\n          position: absolute;\n          bottom: 70px;\n          right: 0;\n          background-color: white;\n          color: #333;\n          padding: 10px 15px;\n          border-radius: 12px;\n          box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);\n          max-width: 220px;\n          opacity: 0;\n          transform: translateY(10px);\n          transition: opacity 0.3s, transform 0.3s;\n          pointer-events: none;\n        }\n\n        .sitehq-dark-mode .sitehq-tooltip {\n          background-color: #2d2d2d;\n          color: #f5f5f5;\n        }\n\n        .sitehq-toggle-button:hover + .sitehq-tooltip {\n          opacity: 1;\n          transform: translateY(0);\n        }\n\n        .sitehq-chat-window {\n          position: absolute;\n          bottom: 70px;\n          right: 0;\n          width: 350px;\n          max-height: 500px;\n          background-color: white;\n          border-radius: 12px;\n          box-shadow: 0 5px 25px rgba(0, 0, 0, 0.15);\n          display: flex;\n          flex-direction: column;\n          overflow: hidden;\n          transition: all 0.3s ease;\n          transform-origin: bottom right;\n          animation: sitehq-popup 0.3s ease-out;\n          display: none;\n        }\n\n        .sitehq-dark-mode .sitehq-chat-window {\n          background-color: #222;\n          box-shadow: 0 5px 25px rgba(0, 0, 0, 0.3);\n        }\n\n        @keyframes sitehq-popup {\n          0% {\n            transform: scale(0.8);\n            opacity: 0;\n          }\n          100% {\n            transform: scale(1);\n            opacity: 1;\n          }\n        }\n\n        .sitehq-header {\n          padding: 15px;\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          border-bottom: 1px solid #eee;\n          background-color: #f9f9f9;\n          position: relative;\n        }\n\n        .sitehq-dark-mode .sitehq-header {\n          border-bottom: 1px solid #333;\n          background-color: #2d2d2d;\n        }\n\n        .sitehq-header-content {\n          display: flex;\n          flex-direction: column;\n          align-items: center;\n          width: 100%;\n        }\n\n        .sitehq-header-title {\n          font-weight: 600;\n          font-size: 16px;\n          color: var(--primary-color, #5c078c);\n        }\n\n        .sitehq-dark-mode .sitehq-header-title {\n          color: #bb86fc;\n        }\n\n        .sitehq-status {\n          font-size: 12px;\n          color: #888;\n          margin-top: 5px;\n        }\n\n        .sitehq-dark-mode .sitehq-status {\n          color: #aaa;\n        }\n\n        .sitehq-status-connected {\n          color: #4CAF50;\n        }\n\n        .sitehq-dark-mode .sitehq-status-connected {\n          color: #81c784;\n        }\n\n        .sitehq-status-disconnected, .sitehq-status-error {\n          color: #F44336;\n        }\n\n        .sitehq-dark-mode .sitehq-status-disconnected,\n        .sitehq-dark-mode .sitehq-status-error {\n          color: #e57373;\n        }\n\n        .sitehq-status-listening {\n          color: #4CAF50;\n        }\n\n        .sitehq-status-speaking {\n          color: #FF9800;\n        }\n\n        .sitehq-equalizer {\n          display: none;\n          flex-direction: row;\n          gap: 3px;\n          margin-top: 5px;\n        }\n\n        .sitehq-equalizer-bar {\n          width: 4px;\n          height: 10px;\n          background-color: #4CAF50;\n          border-radius: 2px;\n          animation: sitehq-wave 1s infinite ease-in-out;\n        }\n\n        .sitehq-equalizer-bar:nth-child(2) {\n          animation-delay: 0.2s;\n        }\n\n        .sitehq-equalizer-bar:nth-child(3) {\n          animation-delay: 0.4s;\n        }\n\n        .sitehq-status-listening ~ .sitehq-equalizer {\n          display: flex;\n        }\n\n        .sitehq-sound-wave {\n          display: none;\n          flex-direction: row;\n          gap: 3px;\n          margin-top: 5px;\n        }\n\n        .sitehq-sound-wave-bar {\n          width: 4px;\n          height: 10px;\n          background-color: #FF9800;\n          border-radius: 2px;\n          animation: sitehq-wave 1s infinite ease-in-out;\n        }\n\n        .sitehq-sound-wave-bar:nth-child(2) {\n          animation-delay: 0.2s;\n        }\n\n        .sitehq-sound-wave-bar:nth-child(3) {\n          animation-delay: 0.4s;\n        }\n\n        @keyframes sitehq-wave {\n          0%, 100% {\n            transform: scaleY(1);\n          }\n          50% {\n            transform: scaleY(2);\n          }\n        }\n\n        .sitehq-status-speaking ~ .sitehq-sound-wave {\n          display: flex;\n        }\n\n        .sitehq-header-actions {\n          position: absolute;\n          right: 15px;\n          display: flex;\n          gap: 8px;\n        }\n\n        .sitehq-icon-button {\n          width: 32px;\n          height: 32px;\n          border-radius: 50%;\n          background-color: transparent;\n          border: none;\n          cursor: pointer;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          color: #555;\n          transition: background-color 0.2s;\n        }\n\n        .sitehq-dark-mode .sitehq-icon-button {\n          color: #ddd;\n        }\n\n        .sitehq-icon-button:hover {\n          background-color: rgba(0, 0, 0, 0.05);\n        }\n\n        .sitehq-dark-mode .sitehq-icon-button:hover {\n          background-color: rgba(255, 255, 255, 0.1);\n        }\n\n        .sitehq-messages {\n          display: none;\n        }\n\n        .sitehq-typing-indicator {\n          display: none;\n          padding: 10px 15px;\n          align-items: center;\n          gap: 5px;\n        }\n\n        .sitehq-typing-dot {\n          width: 8px;\n          height: 8px;\n          background-color: #888;\n          border-radius: 50%;\n          animation: sitehq-typing-dot 1.4s infinite ease-in-out;\n        }\n\n        .sitehq-dark-mode .sitehq-typing-dot {\n          background-color: #aaa;\n        }\n\n        .sitehq-typing-dot:nth-child(1) {\n          animation-delay: 0s;\n        }\n\n        .sitehq-typing-dot:nth-child(2) {\n          animation-delay: 0.2s;\n        }\n\n        .sitehq-typing-dot:nth-child(3) {\n          animation-delay: 0.4s;\n        }\n\n        @keyframes sitehq-typing-dot {\n          0%, 60%, 100% {\n            transform: translateY(0);\n          }\n          30% {\n            transform: translateY(-5px);\n          }\n        }\n\n        .sitehq-input-area {\n          padding: 10px 15px;\n          display: flex;\n          gap: 10px;\n          border-top: 1px solid #eee;\n          background-color: #f9f9f9;\n          justify-content: center;\n        }\n\n        .sitehq-dark-mode .sitehq-input-area {\n          border-top: 1px solid #333;\n          background-color: #2d2d2d;\n        }\n\n        .sitehq-message-input {\n          display: none;\n        }\n\n        .sitehq-send-button {\n          display: none;\n        }\n\n        .sitehq-disconnect-button {\n          width: 40px;\n          height: 40px;\n          border-radius: 50%;\n          background-color: #F44336;\n          color: white;\n          border: none;\n          cursor: pointer;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          transition: background-color 0.2s;\n        }\n\n        .sitehq-disconnect-button:hover {\n          background-color: #d32f2f;\n        }\n\n        .sitehq-terms-dialog {\n          position: fixed;\n          top: 50%;\n          left: 50%;\n          transform: translate(-50%, -50%);\n          width: 100%;\n          height: 100%;\n          background-color: rgba(0, 0, 0, 0.5);\n          backdrop-filter: blur(5px);\n          display: none;\n          align-items: center;\n          justify-content: center;\n          z-index: 1000;\n        }\n\n        .sitehq-terms-content {\n          background-color: white;\n          padding: 20px;\n          border-radius: 12px;\n          width: 90%;\n          max-width: 400px;\n          max-height: 80vh;\n          overflow-y: auto;\n          box-shadow: 0 5px 25px rgba(0, 0, 0, 0.2);\n        }\n\n        .sitehq-dark-mode .sitehq-terms-content {\n          background-color: #2d2d2d;\n          color: #f5f5f5;\n        }\n\n        .sitehq-terms-content h3 {\n          margin-top: 0;\n          color: var(--primary-color, #5c078c);\n        }\n\n        .sitehq-dark-mode .sitehq-terms-content h3 {\n          color: #bb86fc;\n        }\n\n        .sitehq-primary-button {\n          background-color: var(--primary-color, #5c078c);\n          color: white;\n          border: none;\n          padding: 10px 15px;\n          border-radius: 6px;\n          font-weight: 500;\n          cursor: pointer;\n          display: block;\n          width: 100%;\n          margin-top: 15px;\n          transition: background-color 0.2s;\n        }\n\n        .sitehq-dark-mode .sitehq-primary-button {\n          background-color: #bb86fc;\n          color: #000;\n        }\n\n        .sitehq-primary-button:hover {\n          background-color: #4a0670;\n        }\n\n        .sitehq-dark-mode .sitehq-primary-button:hover {\n          background-color: #a370db;\n        }\n\n        .sitehq-cancel-button {\n          background-color: #f5f5f5;\n          color: #333;\n          border: 1px solid #ddd;\n          padding: 8px 16px;\n          border-radius: 6px;\n          cursor: pointer;\n          margin-top: 10px;\n          width: 100%;\n        }\n\n        .sitehq-dark-mode .sitehq-cancel-button {\n          background-color: #333;\n          color: #f5f5f5;\n          border: 1px solid #444;\n        }\n\n        .sitehq-branding {\n          font-size: 11px;\n          color: #888;\n          text-align: center;\n          margin-top: 5px;\n        }\n\n        .sitehq-dark-mode .sitehq-branding {\n          color: #aaa;\n        }\n\n        .sitehq-branding a {\n          color: var(--primary-color, #5c078c);\n          text-decoration: none;\n        }\n\n        .sitehq-dark-mode .sitehq-branding a {\n          color: #bb86fc;\n        }\n\n        .sitehq-branding a:hover {\n          text-decoration: underline;\n        }\n\n        .sitehq-react-container {\n          display: none;\n        }\n      </style>\n      <div class="sitehq-container '.concat(this.config.position?"sitehq-"+this.config.position:"sitehq-bottom-right"," ").concat(this.state.isDarkMode?"sitehq-dark-mode":"",'">\n        <div class="sitehq-chat-window" style="display: none;">\n          <div class="sitehq-header">\n            <div class="sitehq-header-content">\n              <div class="sitehq-header-title">').concat(this.config.widgetTitle||"Chat with AI",'</div>\n              <div class="sitehq-status" id="sitehq-status">Initializing...</div>\n              <div class="sitehq-equalizer">\n                <div class="sitehq-equalizer-bar"></div>\n                <div class="sitehq-equalizer-bar"></div>\n                <div class="sitehq-equalizer-bar"></div>\n                <div class="sitehq-equalizer-bar"></div>\n              </div>\n              <div class="sitehq-sound-wave">\n                <div class="sitehq-sound-wave-bar"></div>\n                <div class="sitehq-sound-wave-bar"></div>\n                <div class="sitehq-sound-wave-bar"></div>\n              </div>\n            </div>\n            <div class="sitehq-header-actions">\n              <button class="sitehq-icon-button" aria-label="Toggle dark mode"></button>\n            </div>\n          </div>\n          <div class="sitehq-messages"></div>\n          <div class="sitehq-typing-indicator" style="display: none;">\n            <div class="sitehq-typing-dot"></div>\n            <div class="sitehq-typing-dot"></div>\n            <div class="sitehq-typing-dot"></div>\n          </div>\n          <div class="sitehq-input-area">\n            <button class="sitehq-disconnect-button" aria-label="Disconnect call"></button>\n          </div>\n        </div>\n        <button class="sitehq-toggle-button" aria-label="Toggle chat"></button>\n        <div class="sitehq-tooltip">Ask me anything! I\'m here to help.</div>\n        <div class="sitehq-terms-dialog" style="display: none;">\n          <div class="sitehq-terms-content">\n            <h3>Terms and Conditions</h3>\n            <p>By clicking " Agree," and each time I interact with this AI agent, I consent to the recording, storage, and sharing of my communications with third-party service providers, and as described in the Privacy Policy. If you do not wish to have your conversations recorded, please refrain from using this service.</p>\n            <button class="sitehq-primary-button"> Agree</button>\n            <button class="sitehq-cancel-button">Cancel</button>\n          </div>\n        </div>\n        <div class="sitehq-branding">Powered by <a href="https://www.sitehq.ai" target="_blank">SiteHQ</a></div>\n        <div class="sitehq-react-container"></div>\n      </div>\n    '),this.refs.container=this.shadowRoot.querySelector(".sitehq-container"),this.refs.chatWindow=this.shadowRoot.querySelector(".sitehq-chat-window"),this.refs.chatButton=this.shadowRoot.querySelector(".sitehq-toggle-button"),this.refs.messagesContainer=this.shadowRoot.querySelector(".sitehq-messages"),this.refs.typingIndicator=this.shadowRoot.querySelector(".sitehq-typing-indicator"),this.refs.messageInput=this.shadowRoot.querySelector(".sitehq-message-input"),this.refs.termsDialog=this.shadowRoot.querySelector(".sitehq-terms-dialog"),this.refs.disconnectButton=this.shadowRoot.querySelector(".sitehq-disconnect-button"),this.refs.reactContainer=this.shadowRoot.querySelector(".sitehq-react-container"),this.refs.chatButton.appendChild(this.createSVG(this.SVGS.chatBubble)),this.refs.disconnectButton.appendChild(this.createSVG(this.SVGS.hangup)),this.updateDarkModeIcon(),this.config.useSolarSystemTheme){var t=document.createElement("div");t.className="sitehq-particle sitehq-sun-particle",t.style.top="-10px",t.style.right="-8px",t.style.width="18px",t.style.height="18px",t.style.backgroundColor="#FFCC00",t.style.boxShadow="0 0 10px rgba(255, 204, 0, 0.8)";var e=document.createElement("div");e.className="sitehq-particle sitehq-planet-particle",e.style.bottom="-5px",e.style.left="-3px",e.style.width="8px",e.style.height="8px",e.style.backgroundColor="#00CCFF",this.refs.chatButton.appendChild(t),this.refs.chatButton.appendChild(e)}else{var n=document.createElement("div");n.className="sitehq-particle";var o=document.createElement("div");o.className="sitehq-particle",this.refs.chatButton.appendChild(n),this.refs.chatButton.appendChild(o)}}},{key:"updateDarkModeIcon",value:function(){var t=this.refs.chatWindow.querySelector('[aria-label="Toggle dark mode"]');t.innerHTML="",t.appendChild(this.createSVG(this.state.isDarkMode?this.SVGS.sun:this.SVGS.moon))}},{key:"setupEventListeners",value:function(){var t=this;this.refs.chatButton.addEventListener("click",(function(){return t.toggleChatWindow(!t.state.isOpen)})),this.refs.chatWindow.querySelector('[aria-label="Toggle dark mode"]').addEventListener("click",(function(){return t.toggleDarkMode()})),this.refs.disconnectButton.addEventListener("click",(function(){return t.disconnectCall()})),this.refs.termsDialog.querySelector(".sitehq-cancel-button").addEventListener("click",(function(){t.refs.termsDialog.style.display="none",t.toggleChatWindow(!1)})),this.refs.termsDialog.querySelector(".sitehq-primary-button").addEventListener("click",(function(){t.state.acceptedTerms=!0,t.refs.termsDialog.style.display="none",t.initializeChat()}))}},{key:"setupReactContainer",value:function(){var t=new CustomEvent("sitehq-init",{detail:{apiKey:this.config.apiKey,agentId:this.config.agentId,container:this.refs.reactContainer}});document.dispatchEvent(t)}},{key:"toggleChatWindow",value:function(t){this.state.isOpen=t,this.refs.chatWindow.style.display=t?"flex":"none",t&&!this.state.acceptedTerms?this.refs.termsDialog.style.display="flex":t||(this.state.acceptedTerms=!1,this.setStatus("disconnected"))}},{key:"toggleDarkMode",value:function(){this.state.isDarkMode=!this.state.isDarkMode,this.state.isDarkMode?this.refs.container.classList.add("sitehq-dark-mode"):this.refs.container.classList.remove("sitehq-dark-mode"),this.updateDarkModeIcon()}},{key:"initializeChat",value:function(){document.dispatchEvent(new CustomEvent("sitehq-accept-terms"))}},{key:"setStatus",value:function(t){this.state.status=t;var e=this.shadowRoot.querySelector("#sitehq-status");e.textContent=t.charAt(0).toUpperCase()+t.slice(1),e.className="sitehq-status sitehq-status-".concat(t),this.refs.typingIndicator.style.display="thinking"===t||this.state.isTyping?"flex":"none"}},{key:"disconnectCall",value:function(){document.dispatchEvent(new CustomEvent("sitehq-disconnect")),this.setStatus("disconnected"),this.state.acceptedTerms=!1,this.state.isOpen=!1,this.refs.chatWindow.style.display="none"}},{key:"cleanup",value:function(){}}])}(A(HTMLElement));return customElements.define("sitehq-chat",B),{}})()));